bug_id,bug_report_analysis,suspicious_files,fixed_files
psf__requests-3362,"The bug report raises a question regarding the differences between `iter_content` and `text` methods of the `requests` library when handling response data. The key confusion noted is that `next(r.iter_content(16*1024, decode_unicode=True))` is returning bytes, while `r.text` is returning a Unicode string. The user expected both methods to produce Unicode output, assuming `iter_content` with `decode_unicode=True` would mirror `r.text` behavior. The user references specific versions: Python 3.5.1 and requests 2.10.0, suggesting a context-sensitive examination. Keywords include 'content', 'iter_content', 'decode_unicode', and 'text'.","{""ranked_list"": [{""file"": ""requests/models.py"", ""justification"": ""Contains the definition of `iter_content`, which is specifically mentioned in the bug report as causing confusion between byte and Unicode data types when used with `decode_unicode=True`. This method's logic regarding decoding is crucial.""}, {""file"": ""requests/sessions.py"", ""justification"": ""Defines the `request` method, which would ultimately manage the responses from `iter_content` and `text`, making it vital for understanding the interaction and instantiation of requests.""}, {""file"": ""requests/api.py"", ""justification"": ""Also defines a `request` function that constructs a request and is involved in how response data is handled, relevant to understanding potential discrepancies in data types.""}, {""file"": ""requests/packages/urllib3/response.py"", ""justification"": ""Implementing the `stream` method, which wraps around reading from underlying responses and is directly connected to how content is processed for transmission, particularly with regards to decoding.""}]}",['requests/utils.py']
psf__requests-2317,"The bug report indicates an issue with how the 'method' variable, which is expected to be a binary string, is being handled in the `requests` library. Specifically, it describes a change in behavior between Python 2.6 and Python 3.4 regarding the `builtin_str` function and how it converts binary strings (e.g., b'GET') to literal strings ('b'GET'). Consequently, the requests library generates a 404 Not Found error because it cannot properly interpret the string format being passed into HTTP requests. Additionally, the report references method conversion issues in `neutronclient`, linking the problem to the way `args` are handled, leading to incorrect formats in method calls. Keywords for this search include: 'builtin_str', 'binary string', 'GET', '404 Not Found', which all suggest a close inspection of the file `requests/sessions.py` where the relevant code resides.","{""ranked_list"": [{""file"": ""requests/sessions.py"", ""justification"": ""This file contains the method 'request' which uses 'builtin_str(method)' to convert the method type, directly linking to the bug report's issue where method handling leads to improper string conversion.""}, {""file"": ""requests/utils.py"", ""justification"": ""The 'utils.py' file contains methods like 'to_native_string' which affect how string and bytes data are handled in requests. This may contribute to the reported binary string issue.""}, {""file"": ""requests/models.py"", ""justification"": ""The 'models.py' includes request preparation methods that could influence how the conversion aspect interacts with request data sent over HTTP requests.""}, {""file"": ""requests/adapters.py"", ""justification"": ""The 'adapters.py' file is crucial as it handles sending requests and may include logic that affects how method types are interpreted during transmission.""}, {""file"": ""requests/auth.py"", ""justification"": ""Auth-related functions might also influence how requests are sent, particularly if authentication headers are improperly formatted due to method type issues.""}, {""file"": ""requests/api.py"", ""justification"": ""This file provides an API interface to make requests, and thus might have links to the underlying conversion problem mentioned in the bug.""}, {""file"": ""requests/exceptions.py"", ""justification"": ""This file centralizes exception handling in the requests library; it\u2019s relevant to explore how errors are propagated if there's a method misinterpretation.""}, {""file"": ""test_requests.py"", ""justification"": ""This test file should contain unit tests for the requests library, which may include cases relevant to the issue, especially regarding the treatment of HTTP methods.""}, {""file"": ""requests/cookies.py"", ""justification"": ""Handling of cookies can be critical when processing HTTP requests; thus, mismanagement of methods and their conversion could indirectly affect this.""}, {""file"": ""requests/packages/urllib3/request.py"", ""justification"": ""Given that urllib3 handles core HTTP functionality, it is essential to review it to understand how requests are processed under the hood.""}]}",['requests/sessions.py']
psf__requests-1963,"The bug report indicates an issue with the `Session.resolve_redirects` method where the original request is incorrectly reused during redirection, causing an erroneous HTTP method to be sent. Specifically, it states that after a 303 redirect (which converts a POST request to a GET), subsequent redirects (like 307) should preserve the original method but do not due to `Session.resolve_redirects` copying the original request. The key components include HTTP methods (POST, GET), the request handling during redirection, and the Session class of the HTTP library.","{""ranked_list"": [{""file"": ""requests/sessions.py"", ""justification"": ""The core of the bug involves the `resolve_redirects` method found in this file. This method directly manages request redirection logic, including modifying the request type based on HTTP status codes. Analyzing this file is crucial because it holds the likely source of the bug.""}, {""file"": ""requests/api.py"", ""justification"": ""Contains the `request` method, which is a public interface for making requests, including handling parameters and managing session requests. This context is vital because it uses `Session.resolve_redirects`, providing a direct connection to the bug.""}, {""file"": ""requests/models.py"", ""justification"": ""The `models.py` file defines the `Request` class used throughout the library for creating request objects. It encapsulates properties such as method, url, and headers, which are influenced by the redirection logic. Understanding it helps gauge how requests are structured and manipulated.""}, {""file"": ""test_requests.py"", ""justification"": ""This test file likely contains various unit tests for the `requests` library, defending against bugs related to request handling, including tests for redirects. It will be helpful to see if there are existing tests related to the redirection behavior described in the bug.""}, {""file"": ""requests/cookies.py"", ""justification"": ""Handles cookies, which may be affected during redirects if cookies from the initial request need to be passed. Understanding this element can be crucial in analyzing how sessions and cookies are affected if they lead to unexpected behavior during HTTP method changes.""}, {""file"": ""requests/exceptions.py"", ""justification"": ""Contains custom exceptions for handling request errors. If the bug leads to unhandled cases during redirects, this file could provide context on how exceptions would be raised, potentially impacting the flow of requests and responses.""}, {""file"": ""requests/adapters.py"", ""justification"": ""Responsible for handling the actual HTTP connections. Any underlying errors in the adapter layer can complicate HTTP method handling. Investigating this file may yield insight into potential routing issues during redirects.""}, {""file"": ""requests/hooks.py"", ""justification"": ""Holds any hooks that could affect the request lifecycle, which might include redirects. If hooks manipulate requests or responses unexpectedly, they could introduce bugs related to how redirects handle original requests.""}, {""file"": ""requests/utils.py"", ""justification"": ""Provides various utility functions that might interact with request formation and processing. Understanding utility functions that interact with requests will shed light on peripheral issues that could affect how HTTP requests are handled.""}, {""file"": ""requests/auth.py"", ""justification"": ""Manages authentication for requests, which might complicate method handling during redirects. If authentication state is carried over incorrectly, it may lead to improper method execution on subsequent requests. This context is relevant as it intersects with redirection handling.""}]}",['requests/sessions.py']
psf__requests-863,"The bug report describes an issue with the `Request` class, specifically its `.register_hook()` method, which currently does not handle multiple hook functions per hook properly. The method expects a single hook function but fails if a list is provided. The `__init__` method of the `Request` class takes a `hooks` parameter but parses it in a way that causes a list of hooks to be wrapped improperly, leading to runtime errors. The report emphasizes the need for the `__init__` method to accept lists in the `hooks` parameter to simplify hook registration. Keywords include 'register_hook,' 'hooks,' 'multiple hooks,' and 'Request class.'","{""ranked_list"": [{""file"": ""requests/models.py"", ""justification"": ""Contains the implementation of the `Request` class and directly includes the relevant methods: `register_hook()` which is central to the bug, and `__init__` which needs modification to support hooks as lists. The analysis showed how `register_hook` currently appends hooks incorrectly, aligning it with the bug's symptoms.""}, {""file"": ""requests/hooks.py"", ""justification"": ""Defined the `dispatch_hook` function, which is likely involved in executing the hooks registered via the `Request` class. This could be critical to understanding how hooks are processed, important for evaluating the bug's impact.""}, {""file"": ""requests/sessions.py"", ""justification"": ""Defines session management for requests, which links hooks to request execution. The presence of hooks in its `__init__` method indicates potential integration with the problem described in the bug report.""}, {""file"": ""requests/utils.py"", ""justification"": ""Although not directly referenced in the bug report, utility functions in this file may support or undermine the architecture for hook management and should not be overlooked.""}]}",['requests/models.py']
psf__requests-2674,"The bug report indicates issues related to the handling of exceptions from the urllib3 library within the requests API. The user is specifically concerned about exceptions like DecodeError and TimeoutError being passed through without proper handling or wrapping. Keywords of interest include 'exceptions', 'requests', 'urllib3', 'DecodeError', and 'TimeoutError', which provide clues for searching relevant files, particularly those dealing with exception handling, connection management, and general request handling.","{""ranked_list"": [{""file"": ""requests/packages/urllib3/exceptions.py"", ""justification"": ""Contains the declaration of exception classes for urllib3, crucial for understanding how these exceptions are raised and handled in the requests library.""}, {""file"": ""requests/adapters.py"", ""justification"": ""Manages how requests are sent and is directly involved in handling errors that are raised, including those from urllib3, such as TimeoutError.""}, {""file"": ""requests/sessions.py"", ""justification"": ""Handles request session management, including error handling and retries, thereby likely interacting with urllib3 exceptions.""}, {""file"": ""requests/packages/urllib3/connectionpool.py"", ""justification"": ""Manages connections and implements methods that would raise exceptions like TimeoutError, making it relevant for understanding the propagation of errors.""}, {""file"": ""requests/packages/urllib3/util/timeout.py"", ""justification"": ""Defines timeouts that could lead to TimeoutErrors, essential for handling scenarios where requests do not respond in a timely manner.""}, {""file"": ""requests/packages/urllib3/util/retry.py"", ""justification"": ""Manages retry logic which is critical for dealing with failed requests that could result in TimeoutError or other exceptions from urllib3.""}, {""file"": ""requests/exceptions.py"", ""justification"": ""Contains definitions related to exceptions raised by the requests library, including how urllib3 exceptions are handled.""}, {""file"": ""requests/packages/urllib3/response.py"", ""justification"": ""Handles HTTP responses and decoding, which may interact with DecodeError when responses are not properly formatted.""}, {""file"": ""requests/utils.py"", ""justification"": ""Contains various utility functions that help handle requests and responses which may indirectly relate to how exceptions are managed.""}, {""file"": ""requests/packages/urllib3/packages/six.py"", ""justification"": ""Utility package that could contain compatibility handling that might be relevant for how exceptions are raised or managed across different Python versions.""}]}",['requests/adapters.py']
psf__requests-2148,"The bug report indicates that a `socket.error` is not being caught/wrapped in a more user-friendly `requests` exception, potentially a `requests.exceptions.ConnectionError`. It specifically mentions experiencing a socket reset, which results in a raw socket error being raised instead of a higher-level `requests` exception. The traceback shows various method calls leading up to the error that occurs in socket.py, suggesting that methods dealing with socket connections and HTTP responses are central to this issue.","{""ranked_list"": [{""file"": ""requests/packages/urllib3/connectionpool.py"", ""justification"": ""This file contains the `urlopen` method which directly manages socket connections and requests. The `_make_request` method handles socket operations and could potentially raise raw socket errors, making it highly relevant to the bug report.""}, {""file"": ""requests/packages/urllib3/response.py"", ""justification"": ""The `read` method in this file is responsible for reading data from the socket and includes handling for errors, such as timeouts and connection issues. This directly relates to the socket error not being handled correctly.""}, {""file"": ""requests/models.py"", ""justification"": ""The `text` method processes the content returned in a response. Though it doesn't handle socket errors directly, it is at a crucial point in the response handling pipeline, impacting how errors are displayed to the end user.""}, {""file"": ""requests/adapters.py"", ""justification"": ""The `send` method in this file is responsible for sending requests and could be involved in how errors are propagated to higher levels. It also integrates with the connection pooling.""}, {""file"": ""requests/packages/urllib3/poolmanager.py"", ""justification"": ""This file manages connection pools and includes methods to manage and get connections which can trigger socket-related issues.""}, {""file"": ""requests/packages/urllib3/exceptions.py"", ""justification"": ""While primarily containing exception definitions, it would play a role in how exceptions (including potential socket errors) are thrown and handled throughout the `requests` module.""}, {""file"": ""test_requests.py"", ""justification"": ""This test file may contain methods testing the `requests` library functionality, including error handling scenarios pertinent to catching socket errors.""}, {""file"": ""requests/packages/urllib3/util/retry.py"", ""justification"": ""This file deals with retry logic on various types of requests, which may interact with socket errors when requests fail.""}, {""file"": ""requests/packages/urllib3/request.py"", ""justification"": ""This file defines the `urlopen` method, abstractly indicating that classes extending RequestMethods should implement their own versions, crucial for understanding socket interactions.""}, {""file"": ""requests/packages/urllib3/util/connection.py"", ""justification"": ""Contains utilities for managing connections, which may be relevant when considering how sockets are established and errors processed.""}]}",['requests/models.py']
